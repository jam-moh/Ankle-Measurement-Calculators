<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SWC Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Segoe UI,sans-serif;
  background:linear-gradient(135deg,#e0f2fe,#fef3c7);
  margin:0;
  color:#111;
}

.back-btn{
  position:fixed;
  top:15px;
  left:15px;
  background:#1e40af;
  color:white;
  padding:8px 14px;
  border-radius:10px;
  text-decoration:none;
  font-weight:600;
  z-index:10;
}

.container{max-width:1000px;margin:auto;padding:30px;}

h1{text-align:center;color:#2563eb;}

.card{
  background:white;
  border-radius:16px;
  padding:20px;
  margin-bottom:25px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

.controls{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:15px;
}

label{font-weight:600;}
input,textarea{
  width:100%;
  padding:8px;
  font-size:1rem;
  border-radius:8px;
  border:1px solid #ccc;
}

textarea{height:120px;resize:vertical;}

button{
  padding:10px 16px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  background:#2563eb;
  color:white;
}

canvas{
  width:100%;
  height:350px;
  border:1px solid #ccc;
  border-radius:12px;
}

.summary{
  margin-top:15px;
  padding:15px;
  border-radius:12px;
  background:#f1f5f9;
  font-size:1rem;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #ccc;
  padding:8px;
}
th{background:#e5e7eb;}
</style>
</head>

<body>

<a class="back-btn" href="https://jam-moh.github.io/Ankle-Measurement-Calculators/">← Back</a>

<div class="container">
<h1>Smallest Worthwhile Change (SWC) Calculator</h1>

<div class="card">
<h3>Paste Paired Data (Pre / Post)</h3>
<p>
Paste two columns of paired values (Pre → Post).  
Values may be <strong>space- or tab-separated</strong>.  
One pair per row. <strong>No commas.</strong>
</p>

<textarea id="dataInput" placeholder="Example:
23.3   31.3
18.8   26.3
24.7   26.3
26.1   33.9
31.9   18.9
23.9   23.8"></textarea>

<button onclick="usePastedData()">Use Pasted Data</button>
</div>

<div class="card controls">
  <div>
    <label>Baseline Mean</label>
    <input type="number" id="baseline" value="0">
  </div>
  <div>
    <label>Follow-up Mean</label>
    <input type="number" id="followup" value="0">
  </div>
  <div>
    <label>SD of Change Scores</label>
    <input type="number" id="sd" value="0">
  </div>
  <div>
    <label>Sample Size (n)</label>
    <input type="number" id="n" value="1" min="1">
  </div>
</div>

<div class="card">
  <canvas id="plot" width="1000" height="350"></canvas>
  <div class="summary" id="summary"></div>
  <button onclick="resetApp()">Reset</button>
</div>

<div class="card">
<h3>Effect Size Interpretation (Hopkins 2002)</h3>
<table>
<tr><th>Magnitude</th><th>Effect Size (Cohen’s d)</th><th>Difference in Means (×SD)</th></tr>
<tr><td>Trivial</td><td>0.0</td><td>0.0</td></tr>
<tr><td>Small</td><td>0.1</td><td>0.2</td></tr>
<tr><td>Moderate</td><td>0.3</td><td>0.6</td></tr>
<tr><td>Large</td><td>0.5</td><td>1.2</td></tr>
<tr><td>Very Large</td><td>0.7</td><td>2.0</td></tr>
<tr><td>Nearly Perfect</td><td>0.9</td><td>4.0</td></tr>
<tr><td>Perfect</td><td>1.0</td><td>∞</td></tr>
</table>

<p>
<em>Reference:</em> Hopkins WG. A spreadsheet for effect size.
<a href="https://www.sportsci.org/resource/stats/effectmag.html" target="_blank">sportsci.org</a>
</p>
</div>

</div>

<script>
const baselineEl=document.getElementById("baseline");
const followupEl=document.getElementById("followup");
const sdEl=document.getElementById("sd");
const nEl=document.getElementById("n");
const summaryEl=document.getElementById("summary");
const ctx=document.getElementById("plot").getContext("2d");

function mean(arr){return arr.reduce((a,b)=>a+b,0)/arr.length;}
function sd(arr){
  const m=mean(arr);
  return Math.sqrt(arr.reduce((s,v)=>s+(v-m)**2,0)/(arr.length-1));
}

function usePastedData(){
  const lines=document.getElementById("dataInput").value.trim().split(/\n+/);
  const pre=[], post=[];

  lines.forEach(line=>{
    const parts=line.trim().split(/\s+/);
    if(parts.length>=2){
      const a=Number(parts[0]), b=Number(parts[1]);
      if(!isNaN(a)&&!isNaN(b)){pre.push(a); post.push(b);}
    }
  });

  if(pre.length<2){
    alert("At least two paired observations are required.");
    return;
  }

  const changeScores=post.map((v,i)=>v-pre[i]);

  baselineEl.value=mean(pre).toFixed(2);
  followupEl.value=mean(post).toFixed(2);
  sdEl.value=sd(changeScores).toFixed(2);
  nEl.value=pre.length;

  updateApp();
}

function computeSWC(){
  const baseline=+baselineEl.value;
  const followup=+followupEl.value;
  const sd=+sdEl.value;
  const n=+nEl.value;
  if(sd<=0||n<1) return null;

  const change=followup-baseline;
  const effectSize=change/sd;
  const swcSmall=0.2*sd;
  const swcModerate=0.6*sd;
  const sem=sd/Math.sqrt(n);

  let interpretation="Trivial";
  if(Math.abs(effectSize)>=0.9) interpretation="Nearly Perfect / Perfect";
  else if(Math.abs(effectSize)>=0.7) interpretation="Very Large";
  else if(Math.abs(effectSize)>=0.5) interpretation="Large";
  else if(Math.abs(effectSize)>=0.3) interpretation="Moderate";
  else if(Math.abs(effectSize)>=0.1) interpretation="Small";

  return{baseline,followup,sd,change,effectSize,swcSmall,swcModerate,sem,interpretation};
}

function drawPlot(d){
  ctx.clearRect(0,0,1000,350);
  const meanVal=d.baseline, sdVal=d.sd;
  const w=1000, h=350;
  let maxY=0, pts=[];

  for(let x=meanVal-4*sdVal;x<=meanVal+4*sdVal;x+=sdVal/20){
    const y=Math.exp(-0.5*((x-meanVal)/sdVal)**2);
    maxY=Math.max(maxY,y);
    pts.push({x,y});
  }

  ctx.beginPath();
  pts.forEach((p,i)=>{
    const px=(p.x-(meanVal-4*sdVal))/(8*sdVal)*w;
    const py=h-p.y/maxY*250-60;
    i?ctx.lineTo(px,py):ctx.moveTo(px,py);
  });
  ctx.strokeStyle="#2563eb"; ctx.lineWidth=2; ctx.stroke();
}

function updateApp(){
  const d=computeSWC(); if(!d) return;
  drawPlot(d);
  summaryEl.innerHTML=`
  Absolute Change: <b>${d.change.toFixed(2)}</b><br>
  Effect Size (Cohen’s d): <b>${d.effectSize.toFixed(2)}</b><br>
  SWC (Small): <b>${d.swcSmall.toFixed(2)}</b><br>
  SWC (Moderate): <b>${d.swcModerate.toFixed(2)}</b><br>
  SEM: <b>${d.sem.toFixed(2)}</b><br>
  Interpretation: <b>${d.interpretation}</b>`;
}

function resetApp(){
  baselineEl.value=0; followupEl.value=0; sdEl.value=0; nEl.value=1;
  ctx.clearRect(0,0,1000,350);
  summaryEl.textContent="";
}

[baselineEl,followupEl,sdEl,nEl].forEach(el=>el.oninput=updateApp);
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const params = new URLSearchParams(window.location.search);
  const fromSuite = params.get('from') === 'suite';

  const body = document.querySelector('body');

  // Create container for buttons (stacked vertically)
  let container = document.getElementById('navButtonsContainer');
  if (!container) {
    container = document.createElement('div');
    container.id = 'navButtonsContainer';
    container.style.display = 'flex';
    container.style.flexDirection = 'column';
    container.style.gap = '10px';
    container.style.position = 'fixed';
    container.style.top = '20px';
    container.style.left = '20px';
    container.style.zIndex = '999';
    body.appendChild(container);
  }

  // Helper to create or update a button
  function addButton(id, text, url, bgColor='#22c55e') {
    let btn = document.getElementById(id);
    if (!btn) {
      btn = document.createElement('button');
      btn.id = id;
      container.appendChild(btn);
    }
    btn.textContent = text;
    btn.style.padding = '10px 18px';
    btn.style.fontSize = '1rem';
    btn.style.border = 'none';
    btn.style.borderRadius = '8px';
    btn.style.cursor = 'pointer';
    btn.style.fontWeight = '600';
    btn.style.backgroundColor = bgColor;
    btn.style.color = '#fff';
    btn.style.boxShadow = '0 3px 6px rgba(0,0,0,0.2)';
    btn.onclick = () => { window.location.href = url; };
  }

  // Suite-2 return button
  addButton('returnSuiteBtn', '⬅ Return to Ankle–Calf Suite', 'https://jam-moh.github.io/ankle-calf-suite-2/');

  // Landing page return button (only if not from Suite-2)
  if (!fromSuite) {
    addButton('returnLandingBtn', '← Return to Landing Page', 'https://jam-moh.github.io/Ankle-Measurement-Calculators/', '#2563eb');
  }
});
</script>

</body>
</html>


</body>
</html>
